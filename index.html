<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://actwu.github.io/neu/n.js"></script>

<script>
setViewport();
setSEO("B Code", "B code a Code Block for Coding Better.", "code, editor, ai", "https://www.example.com/page-url");
addNeu();
</script>

<style>
textarea {
height: 0.2in;
width: min-content;
min-width: min-content;
}
</style>
</head>
<body>
<cont neu small-m bdr="25">
<p m id="output">Run to start Log.</p>
</cont>
<div small-p row id="codeContainer" >

<textarea lbg2 l bdr="25" flex small-p 
class="code-block" draggable="true"
>let a = 5;</textarea>

<textarea rbg2 r bdr="25" flex small-p m 
class="code-block" draggable="true"
>a >= 5 ? alert("ow"): "proceed";</textarea>
</div>

<cont foot>
<div rbg2 bdr="25" id="trashcan">
<i r mid class="fa-solid fa-trash"></i></div>
<cont bbg2 small-p row id="precode">

<a ybg2 y mono onclick="
addCode('out(a);', 'Output');">out</a>
<a lbg2 l mono onclick="
addCode(`let n${ran(9e2)} = ${ran(9e2)};`, 'Value');">var</a>
<a rbg2 r mono onclick="
addCode('condition ? if : else;', 'System');">If</a>

<a rbg2 r mono onclick="
addCode('funcname = () => {};', 'System');">Function</a>

</cont>

<a bdr="25" lbg2 id="runCode"><i mid l  class="fa-solid fa-play"></i></a>
<a bdr="25" gbg2 onmousedown="addCode('Custom Code?')">
<i mid g  class="fa-solid fa-add"></i></a>

<a rbg bdr="25" mid-p onclick="let code = '';
document.querySelectorAll('.code-block').forEach(block => {
code += block.value + '\n';
});
newFile({filename:ran(9e9), filetype:'text/plain', code})

"><i mid r2 class="fa-solid fa-heart"></i></a>
</cont>

<script>

out = (data) => {alert(data)};
document.querySelectorAll('.code-block').forEach(block => {
block.addEventListener('dragstart', dragStart);
block.addEventListener('dragend', dragEnd);
});

let draggedBlock = null;

function dragStart(e) {
draggedBlock = e.target;
e.dataTransfer.setData('text/plain', e.target.value);
setTimeout(() => {
e.target.style.display = 'none';
}, 0);
}

function dragEnd(e) {
e.target.style.display = 'block';
draggedBlock = null;
}

document.getElementById('codeContainer').addEventListener('dragover', dragOver);
document.getElementById('codeContainer').addEventListener('drop', drop);

function dragOver(e) {
e.preventDefault();
}

function drop(e) {
e.preventDefault();
const codeContainer = document.getElementById('codeContainer');
const code = e.dataTransfer.getData('text/plain');

const newBlock = draggedBlock.cloneNode(true);
newBlock.style.display = 'block';
newBlock.value = code;
newBlock.addEventListener('dragstart', dragStart);
newBlock.addEventListener('dragend', dragEnd);

if (e.target === codeContainer) {
codeContainer.appendChild(newBlock);
} else {
e.target.insertAdjacentElement('afterend', newBlock);
}
if (draggedBlock) {
draggedBlock.remove();
}
}

document.getElementById('runCode').addEventListener('click', () => {
let code = '';
document.querySelectorAll('.code-block').forEach(block => {
code += block.value + '\n';
});
try {
document.getElementById('output').innerText = eval(code) == undefined ? "Running" : eval(code);
} catch (err) {
document.getElementById('output').innerText = 'Error: ' + err.message;
}
});


function addCode(code, type) {
const newBlock = document.createElement('textarea');
newBlock.setAttribute('bdr', '25')
if (type == "Output") {
newBlock.setAttribute('ybg2', '')
newBlock.setAttribute('y', '')
} else if (type == "Value") {
newBlock.setAttribute('lbg2', '')
newBlock.setAttribute('l', '')
} else if (type == "System") {
newBlock.setAttribute('rbg2', '')
newBlock.setAttribute('r', '')
} else {
newBlock.setAttribute('bbg2', '')
newBlock.setAttribute('b', '')
}
newBlock.setAttribute('flex', '');
newBlock.setAttribute('small-p', '');
newBlock.setAttribute('m', '');
newBlock.className = 'code-block';
newBlock.draggable = true;
newBlock.value = code;
newBlock.addEventListener('dragstart', dragStart);
newBlock.addEventListener('dragend', dragEnd);
document.getElementById('codeContainer').appendChild(newBlock);
}

const trashcan = document.getElementById('trashcan');
const tcon = document.querySelector('i.fa-trash');


trashcan.addEventListener('dragover', e => {
e.preventDefault();
trashcan.removeAttribute('rbg2');
trashcan.setAttribute('rbg', '');

tcon.removeAttribute('r');
tcon.setAttribute('r2', '');
});

trashcan.addEventListener('dragleave', e => {
e.preventDefault();

trashcan.removeAttribute('rbg');
trashcan.setAttribute('rbg2', '');

tcon.removeAttribute('r2');
tcon.setAttribute('r', '');
});
trashcan.addEventListener('drop', e => {
e.preventDefault();
trashcan.removeAttribute('rbg');
trashcan.setAttribute('rbg2', '');

tcon.removeAttribute('r2');
tcon.setAttribute('r', '');
const code = e.dataTransfer.getData('text/plain');
document.querySelectorAll('.code-block').forEach(block => {
if (block.value === code) {
block.remove();
}
trashcan.removeAttribute('rbg');
trashcan.setAttribute('rbg2', '');

tcon.removeAttribute('r2');
tcon.setAttribute('r', '');
});
});
</script>
</body>
</html>
